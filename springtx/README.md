Spring Transaction
=================

# 1. Transaction의 이해

> 더 이상 쪼갤 수 없는 최소 작업 단위
> commit으로 성공하거나 rollback으로 실패 이후 취소되어야 하는 최소 작업 단위 
> 이 부분에서는 프로그래밍적 트랜잭션보다 spring AOP를 활용하는 선언적 트랜잭션에서 다룰 예정이다.


# 2. Spring이 제공하는 Transaction 핵심기술

1. 트랜잭션 동기화
2. 트랜잭션 추상화
3. AOP를 이용한 트랜잭션 분리

## 2-1. 트랜잭션 동기화

> JDBC를 이용하는 개발자가 직접 여러 개의 작업을 하나의 트랜잭션으로 관리하려면 Connection 객체를 공유하는 등 상당히 불필요한 작업들이 많이 생길 것이다.

> Spring은 이러한 문제를 해결하고자 트랜잭션 동기화(Transaction Synchronization) 기술을 제공하고 있다. 트랜잭션 동기화는 트랜잭션을 시작하기 위한 Connection 객체를 특별한 저장소에 보관해두고 필요할 때 꺼내쓸 수 있도록 하는 기술이다.

> 트랜잭션 동기화 저장소는 작업 쓰레드마다 Connection 객체를 독립적으로 관리하기 때문에, 멀티쓰레드 환경에서도 충돌이 발생할 여지가 없다. 그래서 다음과 같이 트랜잭션 동기화를 적용하게 된다.


## 2-2. 트랜잭션 추상화

> Spring은 트랜잭션 기술의 공통점을 담은 트랜잭션 추상화 기술을 제공한다. 이를 이용함으로써 JDPC, JPA 등 각 기술에 종속적인 코드를 사용하지 않고도 일관적인 트랜잭션 처리가 가능하다.

## 2-3. AOP를 이용한 트랜잭션 분리

> AOP를 이용한 트랜잭션 분리는 선언적 트랜잭션으로 @Transaction 어노테이션을 선언하여 편리하게 트랜잭션을 적용할 수 있다.

> 이와 반대로 트랜잭션 매니저, 트랜잭션 템플릿 등을 사용해서 트랜잭션 관련 코드를 직접 작성하는 것을 프로그래밍 방식의 트랜잭션 관리라 한다. 

> 프로그래밍 방식의 트랜잭션 관리를 사용하게 되면 애플리케이션 코드와 트랜잭션 관리 코드가 강하게 결합하기 때문에 선언적 트랜잭션이 훨씬 간편하고 실용적이다.


# 3. 트랜잭션의 적용위치

> 스프링에서 우선순위는 항상 더 구체적이고 자세한 것이 높은 우선순위를 가진다 

* 우선순위

1. 클래스의 메서드
2. 클래스의 타입
3. 인터페이스의 메서드
4. 인터페이스의 타입

> 가급적 구체 클래스에 @Transaction을 사용하자

# 4. 트랜잭션 AOP 주의사항 - 프록시 내부 호출
























